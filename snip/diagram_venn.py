from __future__ import print_function
from matplotlib import pyplot as plt
import numpy as np
from matplotlib_venn import venn3, venn3_circles, venn2, venn2_circles
from ekstrak_csv import Generator, Ekstraktor
# plt.figure(figsize=(4,4))
# v = venn3(subsets=(1, 1, 1, 1, 1, 1, 1), set_labels = ('A', 'B', 'C'))
# v.get_patch_by_id('100').set_alpha(1.0)
# v.get_patch_by_id('100').set_color('white')
# v.get_label_by_id('100').set_text('Unknown')
# v.get_label_by_id('A').set_text('Set "A"')
# c = venn3_circles(subsets=(1, 1, 1, 1, 1, 1, 1), linestyle='dashed')
# c[0].set_lw(1.0)
# c[0].set_ls('dotted')
# plt.title("Sample Venn diagram")
# plt.annotate('Unknown set', xy=v.get_label_by_id('100').get_position() - np.array([0, 0.05]), xytext=(-70,-70),
#              ha='center', textcoords='offset points', bbox=dict(boxstyle='round,pad=0.5', fc='gray', alpha=0.1),
#              arrowprops=dict(arrowstyle='->', connectionstyle='arc3,rad=0.5',color='gray'))
# plt.show()

# # hasil perankingan top 50 visible 7k 10k 5k 1k:
# set1 = set([1019,21919,12172,6084,460,328,201,2635,11120,13246,11298,20968,
#             8350,1418,8262,344,46,11323,141,21860,10428,243,8137,88,8218,598,17096,
#             501,160,22276,13034,307,887,371,781,24,11570,15602,11110,112,11606,1556,956,21107,
#             7809,18198,2071,959,14530,8366])
#
# # hasil perankingan top 50 layer visible 10k 5k 1k 500:
# set2 = set([12253,2540,13765,328,21234,15890,4196,13246,49,14566,398,22275,11329,11370,641,
#             3274,377,10793,21919,664,2176,2549,5375,12332,8473,14362,4418,137,8181,32,1631,
#             464,16598,9965,27,11314,61,861,39,10112,1019,101,12727,11298,50,4064,8135,54,511,1521])
#
# # hasil perankingan top 50 layer visible 3k 2k 1k 100:
# set3 = set([328,12172,12253,2540,7303,8189,13246,11120,344,22230,201,11356,15602,820,10718,
#             1019,8633,115,9295,15712,14686,1077,4501,10934,11032,18198,11570,244,24,7809,4418,
#             10110,39,8262,21011,275,17199,14210,576,460,6084,9108,8627,8282,
#             268,1418,11327,6682,470,145])
#
# set4 = set([22205,9046,3922,5734,3797,4203,9564,21773,6227,19082,
#             4726,4457,18576,16415,9360,3799,8475,12485,8962,8474,18960,
#             1639,1067,7067,3506,9103,5461,4883,6006,6267,4245,9778,6226,
#             13883,5808,5305,19390,5594,4257,6013,4008,5478,12831,14826,15704,
#             5733,5593,405,18028,2593])
#
set_top_250 = set([22205,9046,3922,5734,3797,4203,9564,21773,6227,19082,4726,4457,18576,16415,9360,3799,8475,12485,
                   8962,8474,18960,1639,1067,7067,3506,9103,5461,4883,6006,6267,4245,9778,6226,13883,5808,5305,19390,
                   5594,4257,6013,4008,5478,12831,14826,15704,5733,5593,405,18028,2593,21985,3391,9326,18427,12617,
                   2051,4168,13352,9777,438,8961,8663,12696,8660,8106,2404,9382,4420,1066,5618,5692,21106,20040,4105,
                   20357,2405,3338,17261,5556,11482,19533,18454,12628,18815,3994,17145,2286,20128,18803,18799,2591,
                   22055,5392,4910,13513,21968,11309,18086,9379,18183,21962,959,12550,21991,1104,20495,9389,3088,
                   15290,8476,8776,4773,11496,12697,12206,4501,18313,3097,16801,875,21107,2274,9325,18422,19229,6183,
                   13278,3679,227,13469,9101,17710,11456,8985,12097,4852,20494,2849,17235,18734,22155,4829,18593,7281,
                   5033,3339,12114,8130,5158,9035,19184,12921,5252,22158,3361,6478,18678,12451,177,21876,3075,9102,
                   18530,4096,13094,5372,1336,2616,9250,4908,13223,3891,1532,18168,11125,12020,2273,12357,12797,
                   12440,18528,3413,6024,540,19366,9021,4931,3270,4481,21576,9197,17135,21992,12761,3680,2436,4529,
                   9031,3775,5504,18074,19019,3074,10222,8973,4430,9487,5134,19045,22231,16889,3598,11737,10121,21200,
                   10673,18080,5080,4997,4959,819,18019,12836,19607,5695,16543,758,289,12999,1995,18456,5508,5409,
                   2534,22147,9579,12064,11738,322,17173,11965,13421,6176,3414,19140,13765,5024,18138,4238,11372])
#
# venn3([set1, set2, set3], ('H 7k 10k 5k 1k ', 'H 10k 5k 1k 500', 'H 3k 2k 1k 100'))
# plt.show()
#
# venn2([set2, set_top_250], ('H 10k 5k 1k 500k ', 'Literatur'))
# plt.show()
#
# venn2([set3, set_top_250], ('H 3k 2k 1k 100k ', 'Literatur'))
# plt.show()

# hasil perankingan top 250 layer visible 10k 5k 1k 500:
set1_250 = set([12253,  2540,13765,  328,21234,15890, 4196,13246,   49,14566,  398,22275, 11329, 11370,  641, 3274,
                377,10793,21919,  664, 2176, 2549, 5375,12332,  8473,14362, 4418,  137, 8181,   32, 1631,  464,16598,
                9965,   27,11314,    61,  861,   39,10112, 1019,  101,12727,11298,   50, 4064, 8135,   54,   511, 1521,
                102, 6279,  318,  405,10484, 3964,12118,15612,11120,13695, 18313,  454, 1716, 1192,22233,  959,21239,
                241, 8249, 6084,11484,  953, 14210,  663,  201,   24,10224, 1556,11068,17116,  232,10513,   46, 8423,
                1833, 1518, 2746, 2586,  254, 8310, 1516,11937,  115,13732,11330,11577, 13625,21860,11756,17539,
                300,1077 ,2660,13706, 1250,18094,  887,10516, 10234,  114,17452,20968,  331, 3470,13741, 8980,13034,
                11969,17209,  397,  9666, 8564,  330,11537,21182,13408,12736,  428,12410,  307,13006,21115,   863,
                243, 1615, 9904, 8582, 8416,11669, 7485, 8125,21513, 3068,21588, 17612,11976, 2323,11208,11149,16820,
                971,12757,11538,  268,12698, 9384,  8364, 3483, 2014, 1548,14551,11435,22142,18988,  568, 1123,21090,
                11810, 21927, 4313, 6016,  645, 6380,12159,20577,13117,  703,22227, 1481,17136, 12967,13256,21691,
                17156,11433,12370,18783, 6115,   47,  159, 1418,  833, 22246, 2635, 2476, 2871,15808, 8185, 2004,
                338,10428, 3800,13602,11796, 11695,20846,  223, 5734,10934, 1901,  879, 2082, 8494, 6843,11060, 1896,
                22108,10303,14797, 2163, 9108, 5150,17405, 7905,  141,12360, 8438, 1306,  1795, 1428,12697,12109,
                7303,12149,10961,16620,13551,11420, 1033,17786, 13729,  261,12184, 1478, 1445,12953,18035,
                633,10690,11462])

# hasil perankingan top 250 visible 7k 10k 5k 1k:
set2_250 = set ([ 1019,21919,12172, 6084,  460,  328,  201, 2635,11120,13246, 11298,20968,  8350, 1418, 8262,
                  344,   46,11323,  141,21860,10428,  243,  8137,   88,  8218,  598,17096,  501,  160,22276,13034,
                  307,  887,  371,   781,   24, 11570,15602,11110,  112,11606, 1556,  956,21107, 7809,18198,  2071,
                  959, 14530, 8366, 3557, 1087,13765,  925,  322, 7361,  184,13025,  202,11497,  8319, 4270,15812,
                  13741,  245, 6279, 3677,11770, 5150, 3745,  308, 7622,  1176,  799,12871,11332, 8078, 6688,11248,
                  8647,  101,10110,18086,12857,  7303,11775,  954, 8442,22230, 1192,  321,22268,17127,12466,21784,
                  15890, 12595,  275, 1366, 4418,  366,14044,  507, 9754,17967, 1029, 8328, 8631, 21031, 8220,
                  50,11695, 1433, 6880,17327, 3171,17465,17343,11370,  849, 15963,11796,17137,  204, 8197,17590,
                  797,12418,  232, 8352,  588, 4562,  1604, 8306, 5243,11147,12673, 8627,  186, 1741,17143, 2906,
                  17216,17473,   319,11612,  511,   77,13817,10706,12727,  100,17339,  290,  265, 8594, 20592,12483,
                  1388,  474,10688,13268, 3546,16762,13207,  274,   45,  114,  6855,  453,13260,18624,12794,12419,
                  728,  577,13078, 1313,  454,18583,  2186, 8268,  879,21976,17446, 8192, 8830, 1766, 8723,11032,
                  1548,11149, 21011,   78,  744,11489,17104,  845,  187, 4196,17457,  145, 4518, 1637,   105,12912,
                  1010,11372,11703,12045,  846,11402, 5324, 1908,  536, 9697, 17134,  115, 9459, 8258, 2533, 8994,
                  11001, 8299, 9666,  393, 2237, 8633, 14772, 3499, 9148,11832,  445, 9911, 1955, 8139,13617,  548,
                  15799, 5333,  8625, 2032, 3891,14752,20743, 7603, 8381,10353,12535,22229])

# hasil perankingan top 250 layer visible 3k 2k 1k 100:
set3_250 = set ([  328,12172,12253, 2540, 7303, 8189,13246,11120,  344,22230,  201,11356, 15602,  820,10718, 1019,
                   8633,  115, 9295,15712,14686, 1077, 4501,10934, 11032,18198,11570,  244,   24, 7809, 4418,10110,
                   39, 8262,21011,  275, 17199,14210,  576,  460, 6084, 9108, 8627, 8282,  268, 1418,11327, 6682,
                   470,  145,   61,21031,11144,22014,14312, 9904,12332,13765,21860,   38, 10112, 8450,  742, 1105,
                   12911,11119,  107,  396, 1521, 9965,12466,17212,  1127,  697, 3700, 3283,  231, 1155,11354, 2636,
                   8611,11376,  971,10501, 13741, 8712,  405,11817,  334,17096,13706,  623,21992, 4332,16762, 1332,
                   22233,21970,11775, 8306,11329, 9666,10893,11417,17327, 6790,13732,17743, 13191,12316,  245,14449,
                   990,12174,   51, 5180,  346,11110,12779,11639,   398, 1414, 9292, 5508, 8568,  879, 8136,   81,
                   232,11669,11704,13239, 11580,   36,  202,  940,16203, 8220, 3513, 8388,14549,15890,11710, 8491,
                   16459,12568, 8339,  445,10490, 1863,17967,10303, 8416,  101,17539,   46, 21098, 8319,14484, 7816,
                   17219, 2804,18988,18103, 2071, 8381,  494, 2171,   184,15334,  989,11065,17684,  281,17369, 4518,
                   308, 7105, 8280, 1021, 11500,17405, 3325,11370,  204,17348, 5243,22222,12794,20968, 8268,  220,
                   21919,11433,  532, 8995,11810,20323, 8137, 9692,12952, 5073, 5986,11147, 11436, 8249,17747, 2897,
                   9937,11576,12727,11367, 1298,22276,  307,  953,    57,  728, 1636, 9986,11314,11298,  621, 8124,
                   8564,  127, 3278,14375, 22023,10601, 1960,  305,17862,  371,17577,12045, 3544,10236,10395, 3758,
                   511,  538,11497,11658,21905, 8196, 9905,  720, 7603,21819])
def plot_venn():
    venn2([set1_250, set_top_250], ('P 1 H 10k 5k 1k 500 ', 'Literatur'))
    plt.title("Top 250 percobaan 1, dengan teknik di literatur 1")
    plt.show()

    venn2([set2_250, set_top_250], ('P 2 H 7k 10k 5k 1k ', 'Literatur'))
    plt.title("Top 250 percobaan 2, dengan teknik di literatur 1")
    plt.show()


    venn2([set3_250, set_top_250], ('P 3 H 3k 2k 1k 100 ', 'Literatur'))
    plt.title("Top 250 percobaan 3, dengan teknik di literatur 1")
    plt.show()

    # venn3([set1_250, set2_250, set3_250], ('P1 H=10k 5k 1k 500', 'P2 H=7k 10k 5k 1k', 'P3 H=3k 2k 1k 100'))
    # plt.title("Perangkingan top 250")
    # plt.show()

if __name__ == '__main__':
    set_all = set1_250 & set2_250 & set3_250
    ekstraktor = Ekstraktor()
    generator = Generator()
    array_rank = np.array(list(set3_250))
    # train = 70.5
    # valid = 15.5
    # test = 14
    # ekstraktor.norm_dataset("./dataset/GSE10072_dataset") # dataset asli untuk dilakukan normalisasi
    # dataset_gse = np.genfromtxt("./dataset/GSE10072_dataset_norm.csv", dtype=float, delimiter=",")
    #  hasil dimasukan ke var dataset_gse
    # generator.top_n_dataset(array_rank, dataset_gse, "./dataset/GSE10072_dataset_rank_set3")
    #  generate dataset dari rankingnya
    # dataset_gse = ekstraktor.generate_dataset("./dataset/GSE10072_dataset_rank_set3",
    #                                            "./dataset/GSE10072_TARGET", train, valid, test, True)
    #
    # plot_venn()
    print(set_all)
